import{j as e,r as w,u as W,b as H,S as F,V as U,a as C,s as S,c as T,_ as n}from"./index-1chCkVik.js";import{i as V,u as v,a as A}from"./index-BTGpsw6g.js";import{C as D}from"./Container-C-BQW1q2.js";import{P as k}from"./Modal-hu0AyHgC.js";import{c as B,T as c}from"./Typography-gYzn-N8Q.js";import{T as l}from"./TextField-CqvKc0RW.js";import{B as x}from"./Button-Cxc8TQoW.js";import{A as P}from"./Avatar-BdPrWYVU.js";import{I as E}from"./IconButton-BinniJZF.js";import"./isMuiElement-CgvdYgho.js";import"./Menu-BaTIauzb.js";const M=B([e.jsx("circle",{cx:"12",cy:"12",r:"3.2"},"0"),e.jsx("path",{d:"M9 2 7.17 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2h-3.17L15 2zm3 15c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5"},"1")],"CameraAlt"),N=f=>{if(!V(f))return{isValid:!1,errorMessage:"Invalid username"}},Z=()=>{const[f,q]=w.useState(!0),[m,j]=w.useState(!1),b=()=>q(d=>!d),p=v(""),g=v(""),r=v("",N),i=v(""),o=A(),y=W(),I=async d=>{var h,u;d.preventDefault();const t={withCredentials:!0,headers:{"Content-Type":"application/json"}};try{const{data:a}=await C.post(`${S}/api/v1/user/login`,{username:r.value,password:i.value},t);y(T(a.user)),n.success(a.message)}catch(a){n.error(((u=(h=a==null?void 0:a.response)==null?void 0:h.data)==null?void 0:u.message)||"Something Went Wrong")}finally{j(!1)}},L=async d=>{var u,a;if(d.preventDefault(),!o.file){n.error("Avatar is required");return}if(!p.value){n.error("Name is required");return}if(!g.value){n.error("Bio is required");return}if(!r.value){n.error("Username is required");return}if(!i.value){n.error("Password is required");return}const t=new FormData;t.append("avatar",o.file),t.append("name",p.value),t.append("bio",g.value),t.append("username",r.value),t.append("password",i.value);const h={withCredentials:!0,headers:{"Content-Type":"multipart/form-data"}};try{const{data:s}=await C.post(`${S}/api/v1/user/new`,t,h);y(T(s.user)),n.success(s.message)}catch(s){n.error(((a=(u=s==null?void 0:s.response)==null?void 0:u.data)==null?void 0:a.message)||"Something Went Wrong"),console.log(s.response.data)}finally{j(!1)}};return e.jsx("div",{style:{backgroundImage:H},children:e.jsx(D,{component:"main",maxWidth:"xs",sx:{height:"100vh",display:"flex",justifyContent:"center",alignItems:"center"},children:e.jsx(k,{elevation:3,sx:{padding:4,display:"flex",flexDirection:"column",alignItems:"center"},children:f?e.jsxs(e.Fragment,{children:[e.jsx(c,{variant:"h5",children:"Login"}),e.jsxs("form",{style:{width:"100%",marginTop:"1rem"},onSubmit:I,children:[e.jsx(l,{required:!0,fullWidth:!0,label:"Username",margin:"normal",variant:"outlined",value:r.value,onChange:r.changeHandler}),e.jsx(l,{required:!0,fullWidth:!0,label:"Password",type:"password",margin:"normal",variant:"outlined",value:i.value,onChange:i.changeHandler}),e.jsx(x,{sx:{marginTop:"1rem"},fullwidth:!0,variant:"contained",color:"primary",type:"submit",disabled:m,children:"Login"}),e.jsx(x,{sx:{marginTop:"1rem"},variant:"text",fullwidth:!0,onClick:b,disabled:m,children:"SignUp instead "})]})]}):e.jsxs(e.Fragment,{children:[e.jsx(c,{variant:"h5",children:"SignUp"}),e.jsxs("form",{style:{width:"100%",marginTop:"1rem"},onSubmit:L,children:[e.jsxs(F,{position:"relative",width:"10rem",margin:"auto",children:[e.jsx(P,{sx:{width:"10rem",height:"10rem",objectFit:"contain"},src:o.preview}),e.jsx(E,{sx:{position:"absolute",bottom:"0",right:"0",color:"white",bgcolor:"rgba(0,0,0,0.5)",":hover":{bgcolor:"rgba(0,0,0,0.7)"}},component:"label",children:e.jsxs(e.Fragment,{children:[e.jsx(M,{}),e.jsx(U,{type:"file",onChange:o.changeHandler})]})})]}),o.error&&e.jsx(c,{margin:"1rem auto",width:"fit-content",display:"block",color:"error",variant:"caption",children:o.error}),e.jsx(l,{required:!0,fullWidth:!0,label:"Name",margin:"normal",variant:"outlined",value:p.value,onChange:p.changeHandler}),e.jsx(l,{required:!0,fullWidth:!0,label:"Bio",margin:"normal",variant:"outlined",value:g.value,onChange:g.changeHandler}),e.jsx(l,{required:!0,fullWidth:!0,label:"username",margin:"normal",variant:"outlined",value:r.value,onChange:r.changeHandler}),r.error&&e.jsx(c,{color:"error",variant:"caption",children:r.error}),e.jsx(l,{required:!0,fullWidth:!0,label:"Password",type:"password",margin:"normal",variant:"outlined",value:i.value,onChange:i.changeHandler}),e.jsx(x,{sx:{marginTop:"1rem"},fullwidth:!0,variant:"contained",color:"primary",type:"submit",disabled:m,children:"SignUp"}),e.jsx(c,{textAlign:"center",m:"1rem",children:"OR"}),e.jsx(x,{sx:{marginTop:"1rem"},variant:"text",fullwidth:!0,onClick:b,disabled:m,children:"Login instead "})]})]})})})})};export{Z as default};
